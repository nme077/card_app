<%- include('./partials/header.ejs') %>
<div class="btn-group dropleft float-right d-block">
    <button type="button" class="btn btn-secondary" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <i class="fas fa-tools"></i>
    </button>
    <div class="dropdown-menu">
        <!-- Dropdown menu links -->
        <a class="dropdown-item" id="print-btn">Print</a>
        <div class="dropdown-divider"></div>
        <form action="/cards/<%= card._id %>?_method=DELETE" method="POST" id="delete_form">
            <button class="dropdown-item submit text-danger" type="submit" data-toggle="modal" data-target="#deleteModal" id="delete_button">Delete</button>
        </form>
      </div>
</div>

  
  <!-- Modal -->
  <div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLongTitle">Delete Card</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          Are you sure you want to delete this card?
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal" id="cancel">Cancel</button>
          <button type="button" class="btn btn-danger" id="confirm">Delete</button>
        </div>
      </div>
    </div>
  </div>

<main class="container main mb-4">

  <div id="form1" id="card-content-input">
    <h3 class="mt-5 pt-5 d-inline" id="card-title"><strong><%= card.name %></strong></h3>
    <button class="btn btn-primary float-right" id="save">Save changes</button>
    <!--Page to print-->
    <div class="page">
        <div class="topofpage d-block">
            <!--Insert card layout-->
        </div>
        <div class="bottomofpage d-block">
            <%- include(`./card_templates/${card.template_choice}`) %>
        </div>
    </div>
  </div>

  <h4 class="text-center">Photo Gallery</h4>
  <!-- Image upload -->
  <div class="container col-sm-10 col-md-8 mb-3" id="image-upload-container">
    <form id="form2" action="/cards/image/upload" method="post" enctype="multipart/form-data">
      <div class="custom-file">
        <input type="file" class="custom-file-input" id="validatedCustomFile" name="imageUpload" accept="image/*">
        <label class="custom-file-label" for="validatedCustomFile">Upload a photo...</label>
      </div>

      <button type="submit" id="upload-img-btn" class="btn btn-primary mt-3" value="form2" style="display: none;">Upload photo</button>
    </form>
  </div>
  
  <div class="container">
    <div class="row">
      <% for(let file of files) { %>
          <div class="imageDiv col-4 col-lg-3 col-xl-2">
              <img class="draggableImage" src="<%= file.href %>" draggable="true">
              <div class="photo-menu">
                <form class="d-inline delete-photo-form" action="/cards/image/<%= file._id %>/<%= file.file_id %>?_method=DELETE" method="POST">
                  <button class="btn btn-clear delete-photo-btn text-white"><i class="far fa-trash-alt"></i></button>
                </form>
            </div>
          </div>
      <% } %> 
    </div>
  </div>
</main>
<%- include('./partials/footer.ejs') %>